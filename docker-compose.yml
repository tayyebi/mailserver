services:
  mailserver:
    build: .
    env_file: .env
    ports:
      - "${SMTP_PORT:-25}:25"
      - "${SUBMISSION_PORT:-587}:587"
      - "${SMTPS_PORT:-465}:465"
      - "${IMAP_PORT:-143}:143"
      - "${IMAPS_PORT:-993}:993"
      - "${POP3_PORT:-110}:110"
      - "${POP3S_PORT:-995}:995"
      - "${HTTPS_PORT:-443}:8080"
    volumes:
      - maildata:/data
    environment:
      - HOSTNAME=${HOSTNAME:-mail.example.com}
      - ADMIN_PORT=8080
      - DB_PATH=/data/db/mailserver.sqlite
      - PIXEL_BASE_URL=https://${HOSTNAME:-mail.example.com}:${HTTPS_PORT:-443}/pixel?id=
      - SEED_USER=${SEED_USER:-admin}
      - SEED_PASS=${SEED_PASS:-admin}
      - TZ=${TZ:-UTC}
    restart: unless-stopped

volumes:
  maildata:
