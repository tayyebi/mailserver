version: '3.8'

services:

  opendkim:
    image: ghcr.io/your-namespace/opendkim:latest
    container_name: opendkim
    restart: unless-stopped
    networks: [mailnet]
    volumes:
      - ./data/opendkim/conf:/etc/opendkim
      - ./data/opendkim/keys:/etc/opendkim/keys
    environment:
      - TZ=${TZ}

  dovecot:
    image: ghcr.io/your-namespace/dovecot:latest
    container_name: dovecot
    restart: unless-stopped
    hostname: ${MAIL_HOST}
    networks: [mailnet]
    ports:
      - "143:143"     # IMAP
      - "993:993"     # IMAPS
    volumes:
      - ./data/dovecot-conf:/etc/dovecot
      - ./data/dovecot:/var/lib/dovecot
      - ./data/mail:/mail
      - ./data/ssl:/etc/ssl/private:ro
    environment:
      - TZ=${TZ}

  postfix:
    image: ghcr.io/your-namespace/postfix:latest
    container_name: postfix
    restart: unless-stopped
    hostname: ${MAIL_HOST}
    domainname: ${MAIL_DOMAIN}
    networks: [mailnet]
    ports:
      - "25:25"       # SMTP
      - "587:587"     # Submission
    volumes:
      - ./data/postfix:/etc/postfix
      - ./data/spool:/var/spool/postfix
      - ./data/ssl:/etc/ssl/private:ro
    environment:
      - TZ=${TZ}
      - SUBMISSION_USER=${SUBMISSION_USER}
      - SUBMISSION_PASS=${SUBMISSION_PASS}
    depends_on:
      - opendkim
      - dovecot

networks:
  mailnet:
    driver: bridge