{% extends "layout.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<section>
    <hgroup>
        <small>Deliverability overview</small>
        <h1>Mailserver Control Panel</h1>
    </hgroup>
    <p>Track DNS, DKIM, and mail flow for {{ hostname }}. Catch issues before they page you.</p>
    <nav>
        <a href="/domains"><strong>Manage domains</strong></a>
        <a href="/accounts">Accounts</a>
        <a href="/aliases">Aliases</a>
        <a href="/settings">Settings</a>
    </nav>
    <dl>
        <dt>Hostname</dt><dd>{{ hostname }}</dd>
        <dt>SMTP</dt><dd>25 / 587 / 465</dd>
        <dt>IMAP</dt><dd>143 / 993</dd>
        <dt>POP3</dt><dd>110 / 995</dd>
    </dl>
</section>

<section>
    <hgroup>
        <small>Platform health</small>
        <h2>Live counters</h2>
    </hgroup>
    <details>
        <summary>How do these refresh?</summary>
        <p>Counts are queried live from PostgreSQL each time you load the console.</p>
    </details>
    <div>
        <article><data value="{{ stats.domain_count }}">{{ stats.domain_count }}</data><strong>Domains</strong><small>Managed zones</small></article>
        <article><data value="{{ stats.account_count }}">{{ stats.account_count }}</data><strong>Accounts</strong><small>Provisioned mailboxes</small></article>
        <article><data value="{{ stats.alias_count }}">{{ stats.alias_count }}</data><strong>Aliases</strong><small>Routing rules</small></article>
        <article><data value="{{ stats.forwarding_count }}">{{ stats.forwarding_count }}</data><strong>Forwarding</strong><small>External routes</small></article>
        <article><data value="{{ stats.dkim_ready_count }}">{{ stats.dkim_ready_count }}</data><strong>DKIM Ready</strong><small>Signed domains</small></article>
        <article><data value="{{ stats.tracked_count }}">{{ stats.tracked_count }}</data><strong>Tracked Messages</strong><small>Pixels injected</small></article>
        <article><data value="{{ stats.open_count }}">{{ stats.open_count }}</data><strong>Pixel Opens</strong><small>Engagement events</small></article>
        <article><data value="{{ stats.webhook_count }}">{{ stats.webhook_count }}</data><strong>Webhooks</strong><small>Events dispatched</small></article>
        <article><data value="{{ stats.unsubscribe_count }}">{{ stats.unsubscribe_count }}</data><strong>Unsubscribes</strong><small>Opt-out records</small></article>
        <article><data value="{{ stats.banned_count }}">{{ stats.banned_count }}</data><strong>Banned IPs</strong><small>Active fail2ban bans</small></article>
    </div>
</section>
{% endblock %}
