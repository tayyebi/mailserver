{% extends "layout.html" %}
{% block title %}Compose Email{% endblock %}
{% block content %}
<h1>Compose Email</h1>
<form method="post" action="/webmail/send">
  <fieldset>
    <label for="account_id">From Account:</label>
    <select name="account_id" id="account_id" required>
      <option value="">— Select account —</option>
      {% for a in accounts %}
      <option value="{{ a.id }}"{% if let Some(sel) = selected_account %}{% if sel.id == a.id %} selected{% endif %}{% endif %}>{{ a.username }}@{{ a.domain_name.as_deref().unwrap_or("?") }}</option>
      {% endfor %}
    </select>

    <label for="to">To:</label>
    <input type="text" name="to" id="to" required placeholder="recipient@example.com">

    <label for="subject">Subject:</label>
    <input type="text" name="subject" id="subject" required>

    <label for="body">Body:</label>
    <textarea name="body" id="body" rows="12" style="width: 100%;"></textarea>

    <button type="submit">Send</button>
  </fieldset>
</form>

{% if !send_log.is_empty() %}
<details open>
  <summary>Send Log</summary>
  <pre>{% for line in send_log %}{{ line }}
{% endfor %}</pre>
</details>
{% endif %}
{% endblock %}
